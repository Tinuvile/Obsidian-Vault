# HW3

---

2352495  张竹和

---

> [!info]
> 1（10分）有一根长度为 n 英寸的铜管和一个非负整数数组，数组包含所有长度不超过 n 的管段的价格。通过切割管道并出售管段来获得最大价值。例如，如果管道长度为8，不同管段的价格如下表所示，则最大可获得价值为22（通过切割为长度2和6的两段）。
> 
> | 长度  | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   |
> | --- | --- | --- | --- | --- | --- | --- | --- | --- |
> | 价格  | 1   | 5   | 8   | 9   | 10  | 17  | 17  | 20  |
> 
> 设计一个动态规划算法，帮助Cooper在给定管道长度和价格表时找到最大可获得价值。 （根据n分析算法）
> 
> (a) 描述你的算法。（给出伪代码） 
> 
> (b) 分析算法的时间复杂度。

**解答**

**（a）** 
子状态：
    长度为`i`的铜管能获得的最大价值，假设用数组`dp[i]`。
   状态转移方程：
    对于每个长度为`i`的铜管，考虑切割为两部分：一部分长度为`j`，后续不切割；一部分长度为`i-j`，后续继续切割。
    则状态转移方程应该是：`dp[i]=max(price[j]+dp[i-j])`。

伪代码：

```text
//Input: Integer n (pipe length), array p[1..n] (p[i] represents the price of a pipe segment of length i) 
//Output: Maximum obtainable value 
dp[0] = 0 
for each length i from 1 to n: 
    Initialize current maximum value: dp[i] ← 0 
    for each cut length j from 1 to i: 
        current candidate value ← p[j] + dp[i- j] 
        if candidate > dp[i]: 
            dp[i] ← candidate 
Return dp[n]
```

**（b）** 
外层循环：遍历长度为 $1$ 到 $n$ 的铜管，共 $n$ 次；
内层循环：对每个长度 $i$ 需要检查 $i$ 种切割方案
总次数：
$$
\sum_{i=1}^{n} i = \frac{n(n+1)}{2} = O(n^2)
$$

---

> [!info] 
> 2（10分）请⽤分⽀限界法对以下背包问题求解。详细给出解空间树，搜索过程及结果。背包容量W=10，物品不可拆分。
> 
> | 物品  | 重量(w) | 价值(v) |
> | --- | ----- | ----- |
> | 1   | 4     | 40    |
> | 2   | 7     | 42    |
> | 3   | 5     | 25    |
> | 4   | 3     | 12    |

**解答**

按照物品的单位价值排序

| 物品  | 重量(w) | 价值(v) | 单位价值 |
| --- | ----- | ----- | ---- |
| 1   | 4     | 40    | 10   |
| 2   | 7     | 42    | 6    |
| 3   | 5     | 25    | 5    |
| 4   | 3     | 12    | 4    |

根节点：选物品1+物品3+物品4的1/3，共69
节点A（选择物品1）：总重量4，价值40，层级1。剩余物品是2、3、4。剩余容量6。此时剩余物品的排序是物品2（6单位价值）、物品3（5）、物品4（4）。物品2重量7，无法装入，所以装物品3（5重量，25），剩余1，装物品4的1/3，得4，总上界40+25+4=69。
节点B（不选物品1）：总重量0，价值0，层级1。剩余物品是2、3、4，剩余容量10。物品2（7重量，42），剩余3容量，装物品3（5不行），装物品4（3，12），总价值42+12=54。

节点A的子节点：选择物品2超过总重量，舍弃。

子节点C（不选择物品2）：此时总重量仍为4，价值40，处理物品3。剩余容量6。剩余物品3、4。 上界=当前价值40 + 剩余容量6的分数解。剩余物品按单位价值排序是物品3（5）和物品4（4）。装物品3（5重量，25），剩余1，装物品4的1/3，得4。上界40+25+4=69。

子节点D（选择物品3）：总重量4+5=9，价值40+25=65。剩余容量10-9=1。处理物品4。此时层级3。而此时已无法选择物品4，故为叶子节点。
子节点E（不选择物品3）：总重量4，价值40，处理物品4，剩余容量6。此时层级3。物品4的重量是3，可以选，总重量4+3=7，价值40+12=52。剩余容量6-3=3。所以该路径的总价值是52，比当前最优解65低，不会更新最优解。

![[Drawing 2025-06-02 15.40.25.excalidraw]]

最大可获得价值为 **65**，对应选择物品1（重量4，价值40）和物品3（重量5，价值25）。

---

> [!info] 
> 3（10分）使⽤分⽀限界法解决下图的旅⾏商问题，从1出发，请给出搜索过程及最优解
> ![[Pasted image 20250602022402.png]]

用矩阵表示路径：  $\begin{bmatrix} \infty & 7 & 5 & 3 & 6 \\ 7 & \infty & 8 & 2 & 4 \\ 5 & 8 & \infty & 9 & 2 \\ 3 & 2 & 9 & \infty & 5 \\ 6 & 4 & 2 & 5 & \infty \end{bmatrix}$

$lcost$表示费用下界；$cc$表示当前费用；$lcost=cc+rcost$；$rcost$表示当前节点的剩余费用，即后续节点的最小出边费用和；$bestc$表示当前找到的最优回路的费用。搜索过程如下：

![[Drawing 2025-06-02 15.46.26.excalidraw]]

故$1→4→2→5→3→1$为最优解，路径长16，有一条等效路径为$1→3→5→2→4→1$。

---

> [!info]
> 4（10分）使用单纯形法解决下面的线性规划问题（标准型视作求最大值），列出标准型和每一步迭代的单纯形表
> $$
> \begin{array}{l}
> \max\quad Z = 2x_1 + 3x_2\\
> \text{s.t.}\quad 
> \begin{cases}
> 2x_1 + 2x_2 \leq 12\\
> x_1 + 2x_2 \leq 8\\
> 4x_1 \leq 16\\
> 4x_2 \leq 12\\
> x_1, x_2 \geq 0
> \end{cases}
> \end{array}
> $$

引入松弛变量 $x_3$，$x_4$，$x_5$，$x_6$ ，将不等式约束化为等式约束：
$$
\begin{align*} \max\quad &Z = 2x_1+3x_2 + 0x_3+0x_4+0x_5+0x_6\\ \text{s.t.}\quad &2x_1 + 2x_2+x_3 = 12\\ &x_1+2x_2+x_4 = 8\\ &4x_1+x_5 = 16\\ &4x_2+x_6 = 12\\ &x_1,x_2,x_3,x_4,x_5,x_6\geq0 \end{align*}
$$
初始单纯形表的一般形式为：

| 基变量   | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ | 常数项 |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- | --- |
| $x_3$ | 2     | 2     | 1     | 0     | 0     | 0     | 12  |
| $x_4$ | 1     | 2     | 0     | 1     | 0     | 0     | 8   |
| $x_5$ | 4     | 0     | 0     | 0     | 1     | 0     | 16  |
| $x_6$ | 0     | 4     | 0     | 0     | 0     | 1     | 12  |
| $Z$   | -2    | -3    | 0     | 0     | 0     | 0     | 0   |

- 第一次迭代：
  进基变量：目标函数中系数最负的变量进基，这里 $-3 < -2$，所以 $x_2$ 进基。
  出基变量：  $\theta=\min\left\{\frac{b_i}{a_{i2}}\mid a_{i2}>0\right\}$：
    - 对于 $x_3$ 所在行：$\frac{12}{2}=6$；
    - 对于 $x_4$ 所在行：$\frac{8}{2} = 4$；
    - 对于 $x_6$ 所在行：$\frac{12}{4}=3$ 。 所以 $x_6$ 出基。
- 行变换：
    - 新的 $x_2$ 行（原来 $x_6$ 行）：$x_2$ 行元素除以 4，得到 $[0, 1, 0, 0, 0, \frac{1}{4}, 3]$ 。
    - $x_3$ 行：$x_3$ 行减去 2 倍新的 $x_2$ 行，得到 $[2, 0, 1, 0, 0, -\frac{1}{2}, 6]$ 。
    - $x_4$ 行：$x_4$ 行减去 2 倍新的 $x_2$ 行，得到 $[1, 0, 0, 1, 0, -\frac{1}{2}, 2]$ 。
    - $Z$ 行：$Z$ 行加上 3 倍新的 $x_2$ 行，得到 $[-2, 0, 0, 0, 0, \frac{3}{4}, 9]$ 。

| 基变量   | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$          | 常数项 |
| ----- | ----- | ----- | ----- | ----- | ----- | -------------- | --- |
| $x_3$ | 2     | 0     | 1     | 0     | 0     | $-\frac{1}{2}$ | 6   |
| $x_4$ | 1     | 0     | 0     | 1     | 0     | $-\frac{1}{2}$ | 2   |
| $x_5$ | 4     | 0     | 0     | 0     | 1     | $0$            | 16  |
| $x_2$ | 0     | 1     | 0     | 0     | 0     | $\frac{1}{4}$  | 3   |
| $Z$   | -2    | 0     | 0     | 0     | 0     | $\frac{3}{4}$  | 9   |

- 第二次迭代：
  进基变量：$Z$ 行中 $-2$ 最负，所以 $x_1$ 进基。
  出基变量：$\theta=\min\left\{\frac{b_i}{a_{i1}}\mid a_{i1}>0\right\}$。
    - 对于 $x_3$ 所在行：$\frac{6}{2}=3$；
    - 对于 $x_4$ 所在行：$\frac{2}{1}=2$；
    - 对于 $x_5$ 所在行：$\frac{16}{4} = 4$ 。 所以 $x_4$ 出基。
  进行初等行变换：
    - 新的 $x_1$ 行（原来 $x_4$ 行）：元素不变 $[1, 0, 0, 1, 0, -\frac{1}{2}, 2]$ 。
    - $x_3$ 行：$x_3$ 行减去 2 倍新的 $x_1$ 行，得到 $[0, 0, 1, -2, 0, \frac{1}{2}, 2]$ 。
    - $x_5$ 行：$x_5$ 行减去 4 倍新的 $x_1$ 行，得到 $[0, 0, 0, -4, 1, 2, 8]$ 。
    - $Z$ 行：$Z$ 行加上 2 倍新的 $x_1$ 行，得到 $[0, 0, 0, 2, 0, -\frac{1}{4}, 13]$ 。

| 基变量   | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$          | 常数项 |
| ----- | ----- | ----- | ----- | ----- | ----- | -------------- | --- |
| $x_3$ | 0     | 0     | 1     | -2    | 0     | $\frac{1}{2}$  | 2   |
| $x_1$ | 1     | 0     | 0     | 1     | 0     | $-\frac{1}{2}$ | 2   |
| $x_5$ | 0     | 0     | 0     | -4    | 1     | $2$            | 8   |
| $x_2$ | 0     | 1     | 0     | 0     | 0     | $\frac{1}{4}$  | 3   |
| $Z$   | 0     | 0     | 0     | 2     | 0     | $-\frac{1}{4}$ | 13  |

此时 $Z$ 行系数均非负，达到最优解。最优解为 $x_1 = 2$，$x_2 = 3$，$Z = 13$ 。

---

> [!info]
> 5（20 分）你有m个相同的鸡蛋和一个n层的建筑。你需要找出最高的楼层$b \in \{0, 1, 2, \ldots, n\}$，使得从该楼层或更低楼层扔下鸡蛋不会破裂。每个鸡蛋从$b + 1$层或更高楼层扔下时总会破裂$(b = 0$表示鸡蛋总是破裂）。一旦鸡蛋破裂，就不能再使用。但如果鸡蛋没有破裂，可以重复使用。
> 
> 设$f(n, m)$为找到b所需的最少鸡蛋掉落次数（无论$b$的值是多少）。
> 
> (a)[4 分] 求$f(1, m)$，$f(0, m)$，$f(n, 1)$和$f(n, 0)$。简要解释你的答案。
> 
> (b)[3 分] 考虑在有$n$层和$m$个鸡蛋剩余时，从第$h$层扔下一个鸡蛋。鸡蛋要么破裂，要么不破裂。在这两种情况下，分别用$f(\cdot, \cdot)$，$n$，$m$，$h$表示找到$b$所需的最少剩余鸡蛋掉落次数。
> 
> (c)[3 分] 找出\(f(n, m)\)的递推关系。
> 
> (d)[2 分] 分析你的动态规划算法的时间复杂度。
> 
> (e)[2 分] 分析你的动态规划算法的空间复杂度。
> 
> (f)[6 分] 是否可以修改你的算法以减少空间使用？如果可以，描述你的修改并重新分析空间复杂度。如果不行，简要说明理由。
> 

**（a）**
- $f(1,m)=1$：只有一层楼，扔一次即可确定；
- $f(0,m)=0$：不需要扔；
- $f(n,1)=n$：只有一个鸡蛋，为确定临界楼层，必须从第一层开始逐层往上直至鸡蛋破裂。最坏情况下需要$n$次；
- $f(n, 0)=\infty$：没有鸡蛋无法测试

**（b）**
- 如果鸡蛋破裂：临界楼层在$h-1$或以下，最少剩余掉落次数为$f(h-1,m-1)$；
- 如果鸡蛋不破裂：临界楼层在$h$或以上，最少剩余掉落次数为$f(n-h,m)$

**（c）**
对于$f(n, m)$，从第h层扔鸡蛋（$1\leq h\leq n$ ），取所有可能$h$值中使得总掉落次数最小的情况。因为扔一次鸡蛋后，会出现破裂或不破裂两种情况，要考虑最不利的情况（即取破裂和不破裂两种情况中次数较大的那个 ），再加上当前扔的这一次，所以递推关系为：  
$$
f(n,m)=\min_{1\leq h\leq n}\{\max\{f(h - 1,m - 1),f(n - h,m)\}+1\}
$$

**（d）**
计算$f(n,m)$，需要计算每一个$f(i,j)$（$0\leq i\leq n$，$0\leq j\leq m$ ）。计算每一个$f(i,j)$时，需要枚举$h$（$1\leq h\leq i$ ）来求最小值，最多枚举$i$次。故总的时间复杂度为
$$
O(nm\times n)=O(n^{2}m)
$$

**（e）**
使用一个二维数组（表）来存储$f(n,m)$的值，大小为$(n + 1)\times(m + 1)$（考虑$n = 0$和$m = 0$的边界 ）。所以空间复杂度为
$$
O(nm)
$$

**（f）**
递推关系$f(n,m)=\min_{1\leq h\leq n}\{\max\{f(h - 1,m - 1),f(n - h,m)\}+1\}$中 ，计算$f(n,m)$时，只依赖于$f(i,m - 1)$（$i < n$ ）和$f(j,m)$（$j < n$ ）的值。所以可以使用两个一维数组来滚动更新，而不是使用二维数组。即用一个数组`dp1`存储$m - 1$个鸡蛋时不同楼层数对应的最少掉落次数，用另一个数组`dp2`存储$m$个鸡蛋时不同楼层数对应的最少掉落次数。在计算$m$个鸡蛋的情况时，根据`dp1`和`dp2`已有的值来更新`dp2`。这样空间复杂度降为$O(n)$。

